FROM node:20 AS build

WORKDIR /MisaServerCoreFE

COPY package*.json ./

ARG MISA_HOST_LOCAL
ARG MISA_HOST
ARG HOST
ARG IS_PROD
ARG PORT
ARG MISA_FILES_ENTRY_HOST
ARG MISA_FILES_ENTRY_PORT

ENV IS_PROD=true
ENV HOST=0.0.0.0
ENV IS_PROD=true
ENV PORT=8080
ENV MISA_FILES_ENTRY_HOST=http://MisaFilesFE
ENV MISA_FILES_ENTRY_PORT=8081

RUN npm install

COPY . .

RUN npm run build

EXPOSE 8080

CMD ["npm", "run", "serve"]
